<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2048测试 - 数字块显示修复</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: #faf8ef;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 10px;
            color: #776e65;
            overflow-x: hidden;
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #bbada0;
            border-radius: 12px;
            padding: 15px;
            width: 100%;
            max-width: 350px;
            margin: 10px 0;
            position: relative;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #776e65;
            margin: 8px 0 10px;
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            font-family: Arial, sans-serif;
        }
        
        .game-board {
            width: 100%;
            aspect-ratio: 1/1;
            background: #bbada0;
            border-radius: 8px;
            padding: 6px;
            margin-bottom: 12px;
            position: relative;
            touch-action: none;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        .cell {
            position: absolute;
            background: rgba(238, 228, 218, 0.35);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            transition: all 0.15s ease;
            width: calc(25% - 6px);
            height: calc(25% - 6px);
        }
        
        .tile {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            border-radius: 6px;
            transition: all 0.15s ease;
            width: calc(25% - 6px);
            height: calc(25% - 6px);
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .tile.new {
            animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .tile-2 { background: #eee4da; color: #776e65; font-size: 18px; }
        .tile-4 { background: #ede0c8; color: #776e65; font-size: 18px; }
        .tile-8 { background: #f2b179; color: #f9f6f2; font-size: 18px; }
        .tile-16 { background: #f59563; color: #f9f6f2; font-size: 16px; }
        .tile-32 { background: #f67c5f; color: #f9f6f2; font-size: 16px; }
        .tile-64 { background: #f65e3b; color: #f9f6f2; font-size: 16px; }
        .tile-128 { background: #edcf72; color: #f9f6f2; font-size: 16px; }
        .tile-256 { background: #edcc61; color: #f9f6f2; font-size: 16px; }
        .tile-512 { background: #edc850; color: #f9f6f2; font-size: 16px; }
        .tile-1024 { background: #edc53f; color: #f9f6f2; font-size: 14px; }
        .tile-2048 { background: #edc22e; color: #f9f6f2; font-size: 14px; }
        
        .tile-4096 { background: #ff0000; color: #f9f6f2; font-size: 14px; }
        .tile-8192 { background: #ff00ff; color: #f9f6f2; font-size: 14px; }
        
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        
        .buttons {
            display: flex;
            gap: 8px;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 16px;
            font-size: 0.9rem;
            background: #8f7a66;
            color: #f9f6f2;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        button:hover {
            background: #7c6b5a;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        
        .test-info {
            margin-top: 20px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            max-width: 350px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>2048 - 测试修复</h1>
        <div class="game-board" id="board"></div>
        <div class="buttons">
            <button onclick="testDrawBoard()">测试绘制数字块</button>
            <button onclick="clearBoard()">清空棋盘</button>
        </div>
    </div>
    
    <div class="test-info">
        <h3>测试说明</h3>
        <p>点击"测试绘制数字块"按钮来验证数字块是否能正常显示</p>
        <p>如果数字块显示正常，则修复成功</p>
    </div>

    <script>
        const GRID_SIZE = 4;
        let grid = [];
        
        // 初始化测试网格
        function initTestGrid() {
            grid = Array(GRID_SIZE).fill().map(() => Array(GRID_SIZE).fill(0));
            // 添加一些测试数字
            grid[0][0] = 2;
            grid[0][1] = 4;
            grid[0][2] = 8;
            grid[0][3] = 16;
            grid[1][0] = 32;
            grid[1][1] = 64;
            grid[1][2] = 128;
            grid[1][3] = 256;
            grid[2][0] = 512;
            grid[2][1] = 1024;
            grid[2][2] = 2048;
            grid[2][3] = 4096;
            grid[3][0] = 8192;
            grid[3][1] = 2;
            grid[3][2] = 4;
            grid[3][3] = 8;
        }
        
        // 绘制游戏板
        function drawBoard() {
            const boardElement = document.getElementById('board');
            boardElement.innerHTML = '';
            
            // 创建背景格子
            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.style.top = `${y * 25}%`;
                    cell.style.left = `${x * 25}%`;
                    boardElement.appendChild(cell);
                }
            }
            
            // 创建方块
            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    if (grid[y][x] !== 0) {
                        const tile = document.createElement('div');
                        tile.className = `tile tile-${grid[y][x]} new`;
                        tile.textContent = grid[y][x];
                        // 设置位置
                        tile.style.top = `${y * 25}%`;
                        tile.style.left = `${x * 25}%`;
                        // 确保方块大小正确
                        tile.style.width = `calc(25% - 6px)`;
                        tile.style.height = `calc(25% - 6px)`;
                        // 确保方块有足够的z-index
                        tile.style.zIndex = '10';
                        // 确保方块内容居中
                        tile.style.display = 'flex';
                        tile.style.alignItems = 'center';
                        tile.style.justifyContent = 'center';
                        boardElement.appendChild(tile);
                        
                        // 动画结束后移除 new 类
                        setTimeout(() => {
                            tile.classList.remove('new');
                        }, 200);
                    }
                }
            }
        }
        
        // 测试绘制
        function testDrawBoard() {
            initTestGrid();
            drawBoard();
        }
        
        // 清空棋盘
        function clearBoard() {
            grid = Array(GRID_SIZE).fill().map(() => Array(GRID_SIZE).fill(0));
            drawBoard();
        }
        
        // 初始绘制
        window.onload = function() {
            initTestGrid();
            drawBoard();
        };
    </script>
</body>
</html>